import{h as d}from"./hiddenContentLoader-2Hn9pDKt.js";import{r as l,h as p,f as h}from"./api-Bqt0gWw5.js";import{c as b}from"./createToken-BCfxSjGu.js";import{c as w,s as g}from"./showPhoto-DbG4j3_m.js";function m(){return!!new URL(window.location.href).searchParams.get("redact")}const e={form:document.querySelector(".change-profile-form"),title:document.querySelector(".change-profile__title"),photo:document.querySelector(".change-profile-form__img"),password:document.querySelector(".change-profile-form__item_password"),btnSubmit:document.querySelector(".change-profile-form__btn-submit"),error:document.querySelector(".change-profile__error")};async function n(t){t.preventDefault(),await v();try{const o=w(e.form);if(m())await l(o);else{const r=await p(o);b(r.token)}window.location.href="profile.html"}catch{e.error.textContent="Неравельно ввід або такий юзер вже є",_()}}async function v(){e.form.addEventListener("submit",u),e.form.removeEventListener("submit",n)}function _(){e.form.removeEventListener("submit",u),e.form.addEventListener("submit",n)}function u(t){t.preventDefault()}async function y(){const{username:t,adress:o,phone:r,email:f}=e.form,a={username:t,adress:o,phone:r,email:f},{user:i}=await h();for(const c in a)a[c].value=i[c];const s=document.querySelector(".change-profile-form__svg");s.src=i.avatar,s.classList.add("big-photo")}function S(){e.title.textContent="Редактировка",e.btnSubmit.textContent="Зберегти",e.password.remove()}async function L(){S(),await y()}e.photo.onchange=g.bind(void 0,e.photo);m()&&await L();e.form.addEventListener("submit",n);d();
