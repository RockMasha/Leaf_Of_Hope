import{h as S}from"./hiddenContentLoader-BvZHvYTg.js";import{b as w,c as L,e as _,p as A}from"./api-Bqt0gWw5.js";import{c as E,s as q}from"./showPhoto-DbG4j3_m.js";import{s as D,r as P}from"./setInProgressLoader-BAB2lVXe.js";import{i as F}from"./isSignin-DGFatcK1.js";const t={form:document.querySelector(".form-advert"),photo:document.querySelector(".form-advert__img"),btnSubmit:document.querySelector(".form-advert__btn-submit"),error:document.querySelector(".formAdvert__error")};function i(e){return new URL(window.location.href).searchParams.get(e)}async function I(){const{alergenicity:e,humidity:o,lifeDuration:r,light:n,name:l,size:v,temperature:b,way:g,wish:p,description:h}=t.form,s={alergenicity:e,humidity:o,lifeDuration:r,light:n,name:l,size:v,temperature:b,way:g,wish:p,description:h},y=i("id"),m=await w(y);for(const d in s){const u=`${m[d]}`;s[d].value=u!=="undefined"?u:""}const c=document.querySelector(".form-advert__svg");c.src=m.image,c.classList.add("big-photo")}async function C(){await I(),t.btnSubmit.textContent="Зберегти"}async function a(e){e.preventDefault(),k(),D();try{const o=E(t.form),r=i("id");if(r)await L(r,o);else{const n=_();await A(o,n)}history.go(-1)}catch(o){console.log(o),x(),t.error.textContent="Неравельно ввід"}finally{P()}}async function k(){t.form.addEventListener("submit",f),t.form.removeEventListener("submit",a)}function x(){t.form.removeEventListener("submit",f),t.form.addEventListener("submit",a)}function f(e){e.preventDefault()}const z=i("id");z?await C():F();t.photo.onchange=q.bind(void 0,t.photo);t.form.addEventListener("submit",a);S();
